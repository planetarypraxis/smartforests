{% extends "base.html" %}
{% load ckdjango_tags ckbootstrap_tags wagtailcore_tags %}

{% block content %}
<main class="container-fluid mb-7">
  <div class="row gx-0 mt-7">
    <header class="col-lg-6 offset-lg-3">
      <h1 class="mb-5">{{self.title}}</h1>
    </header>
  </div>
  <div class="row gx-0">
    <aside class="col-lg-2 d-none d-md-flex flex-column microcopy">
      <section class="d-flex flex-column mb-3">
        <time class="text-dark-grey" datetime="{{ self.first_published_at|date:"Y-m-d" }}">
          Added {{ self.first_published_at|date:"d E Y" }}
        </time>
        <time class="text-dark-grey" datetime="{{ self.last_published_at|date:"Y-m-d" }}">
          Last edited {{ self.last_published_at|date:"d E Y" }}
        </time>
      </section>
      <section class="d-flex flex-column mb-3">
        <h4 class="mb-0">Contributors</h4>
        <a>{% if self.owner.first_name and self.owner.last_name %}{{ self.owner.first_name }} {{ self.owner.last_name }}{% else %}{{ self.owner }}{% endif %}</a>
        <!-- {% for entry in child_page_list %}
        <a>{% if entry.owner.first_name and entry.owner.last_name %}{{ entry.owner.first_name }} {{ entry.owner.last_name }}{% else %}{{ entry.owner }}{% endif %}</a>
        {% endfor %} -->
      </section>
      <section class="d-flex flex-column mb-3">
        <h4 class="mb-0">Location</h4>
        {% if self.geographical_location %}
        <div>{{ self.geographical_location }}</div>
        {% endif %}
        {% if self.coordinates %}
          <div>{{ self.latitude | floatformat:4}}° N, {{ self.longitude | floatformat:4}}° E</div>
        {% endif %}
      </section>
      <section class="d-flex flex-column">
        <h4>Tags</h4>
        <div class="d-flex flex-column">
        {% for tag in self.tags.all %}
          {% include "logbooks/tag_label.html" with tag=tag orientation="vertical" %}
        {% endfor %}
        </div>
      </section>
    </aside>
    <section class="col-lg-6 offset-lg-1 gx-0">
      <div>
        {% if self.description %}
        <div class="bg-white rounded-1 p-3">
          {{self.description|richtext}}
        </div>
        {% endif %}
      </div>
      <div class="row row-cols-1 gx-0 gy-7">
      {% for entry in child_page_list %}
        <div class="col">
          {{entry.content_html}}
        </div>
      {% endfor %}
      </div>
    </section>
  </div>
</main>
{% endblock %}

<!-- The Masonry component doesn't get on with the flex: 1 we usually stick at the bottom of the page -->
{% block spacer %}
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/infinite-scroll@3/dist/infinite-scroll.pkgd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/masonry-layout@4/dist/masonry.pkgd.min.js" crossorigin="anonymous"></script>
{% endblock %}